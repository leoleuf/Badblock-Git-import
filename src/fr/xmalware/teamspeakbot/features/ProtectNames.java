package fr.xmalware.teamspeakbot.features;

import java.util.HashMap;
import java.util.Map;
import java.util.UUID;

import com.github.theholywaffle.teamspeak3.TS3Api;
import com.github.theholywaffle.teamspeak3.api.ChannelProperty;
import com.github.theholywaffle.teamspeak3.api.wrapper.ChannelInfo;

import fr.xmalware.teamspeakbot.Main;
import fr.xmalware.teamspeakbot.channels.ConfigChannel;

public class ProtectNames
{
	
	public static void check(int channelId, int invokerId)
	{
		TS3Api api = Main.getTeamSpeak().getApi();
		ChannelInfo channel = api.getChannelInfo(channelId);
		if (channel.isPermanent())
		{
			return;
		}
		for (ConfigChannel cc : Main.getTeamSpeak().getChannels())
		{
			if (channel.getName().startsWith(cc.getPrefix()))
			{
				Map<ChannelProperty, String> map = new HashMap<>();
				map.put(ChannelProperty.CHANNEL_NAME, "Lolnope. " + UUID.randomUUID().toString().replace("-", "").toLowerCase().substring(0, 6));
				api.editChannel(channel.getId(), map);
				api.pokeClient(invokerId, "Vous n'avez pas le droit de faire cela.");
				break;
			}
		}
	}

}
