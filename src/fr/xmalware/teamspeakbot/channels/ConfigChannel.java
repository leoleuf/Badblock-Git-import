package fr.xmalware.teamspeakbot.channels;

import java.util.HashMap;
import java.util.Map;

import com.google.gson.JsonArray;
import com.google.gson.JsonElement;
import com.google.gson.JsonObject;

import fr.xmalware.teamspeakbot.Main;
import fr.xmalware.teamspeakbot.utils.ConfigUtils;
import lombok.Data;

@Data
public class ConfigChannel {
	
	private JsonObject	jsonObject;
	private	String		parent;
	private	String		prefix;
	private JsonArray	parameters;
	private JsonArray	permissions;
	private JsonArray	fillPermissions;
	private JsonArray	unfillPermissions;
	private JsonArray	fillParameters;
	private JsonArray	unfillParameters;
	private Map<Integer, Boolean> fill;
	
	public ConfigChannel(JsonObject jsonObject) {
		setJsonObject(jsonObject);
		setFill(new HashMap<>());
		setParent(getField("parent", "Channels"));
		setPrefix(getField("prefix", "Channel Number"));
		setParameters(getArray("parameters", new JsonArray()));
		setPermissions(getArray("permissions", new JsonArray()));
		setFillPermissions(getArray("fillPermissions", new JsonArray()));
		setUnfillPermissions(getArray("unfillPermissions", new JsonArray()));
		setFillParameters(getArray("fillParameters", new JsonArray()));
		setUnfillParameters(getArray("unfillParameters", new JsonArray()));
	}

	private <T> JsonElement getElement(String fieldName, T defaultValue) {
		return ConfigUtils.get(Main.getTeamSpeak().getGson(), getJsonObject(), fieldName, defaultValue);
	}

	private String getField(String fieldName, String defaultValue) {
		return getElement(fieldName, defaultValue).getAsString();
	}
	
	private JsonArray getArray(String fieldName, JsonArray defaultValue) {
		return getElement(fieldName, defaultValue).getAsJsonArray();
	}
	
}
