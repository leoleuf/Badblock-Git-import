package fr.xmalware.badblock.secure.commands;

import com.google.gson.JsonObject;

import fr.badblock.ladder.api.Ladder;
import fr.badblock.ladder.api.commands.Command;
import fr.badblock.ladder.api.entities.CommandSender;
import fr.badblock.ladder.api.entities.OfflinePlayer;
import fr.xmalware.badblock.secure.i18n.I18N;

public class RemovePasswordCommand extends Command {
	
	public RemovePasswordCommand() {
		super ("rmpassword", null, "removepassword");
	}
	
	@Override
	public void executeCommand(CommandSender sender, String[] args) {
		if (!sender.hasPermission("ladder.commands.removepassword")) {
			sender.sendMessage(I18N.getTranslatedMessage("commands.permission"));
			return;
		}
		if (args.length != 1) {
			sender.sendMessage("§cUsage: /rmpassword <pseudo>");
			return;
		}
		String pseudo = args[0];
		OfflinePlayer offlinePlayer = Ladder.getInstance().getOfflinePlayer(pseudo);
		if (offlinePlayer == null) return;
		JsonObject jsonObject = new JsonObject();
		jsonObject.addProperty("loginPassword", "");
		offlinePlayer.updateData(jsonObject);
		sender.sendMessage("§aMot de passe de " + args[0] + " reset.");
	}
	
}
