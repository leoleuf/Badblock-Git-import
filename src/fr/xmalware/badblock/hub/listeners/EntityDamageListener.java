package fr.xmalware.badblock.hub.listeners;

import org.bukkit.entity.ItemFrame;
import org.bukkit.entity.Player;
import org.bukkit.event.EventHandler;
import org.bukkit.event.entity.EntityDamageByEntityEvent;
import org.bukkit.event.entity.EntityDamageEvent;
import org.bukkit.event.entity.EntityDamageEvent.DamageCause;
import org.bukkit.event.player.PlayerArmorStandManipulateEvent;

import fr.badblock.gameapi.events.fakedeaths.FightingDeathEvent;
import fr.badblock.gameapi.events.fakedeaths.NormalDeathEvent;
import fr.xmalware.badblock.hub.objects.HubPlayer;

public class EntityDamageListener extends _HubListener {

	@EventHandler
	public void onPlayerArmorStandManipulate(PlayerArmorStandManipulateEvent event) {
		HubPlayer lobbyPlayer = HubPlayer.get(event.getPlayer());
		event.setCancelled(!lobbyPlayer.isAdmin());
	}

	@EventHandler
	public void onEntityDamageByEntity(EntityDamageByEntityEvent event) {
		if (event.getCause().equals(DamageCause.ENTITY_ATTACK) && event.getEntity() instanceof ItemFrame) {
			if (event.getDamager() instanceof Player) {
				HubPlayer lobbyPlayer = HubPlayer.get((Player) event.getDamager());
				event.setCancelled(!lobbyPlayer.isAdmin());
			}
		}else event.setCancelled(true);
	}

	@EventHandler
	public void onEntityDamage(EntityDamageEvent event) {
		if (!event.getCause().equals(DamageCause.ENTITY_ATTACK) && !(event.getEntity() instanceof ItemFrame))
			event.setCancelled(true);
	}

	@EventHandler
	public void onFightingDeath(FightingDeathEvent event) {
		event.setCancelled(true);
	}

	@EventHandler
	public void onNormalDeath(NormalDeathEvent event) {
		event.setCancelled(true);
	}

}
