package fr.xmalware.badblock.hub;

import com.google.gson.Gson;
import com.google.gson.GsonBuilder;

import fr.badblock.gameapi.BadblockPlugin;
import fr.badblock.gameapi.run.RunType;
import fr.xmalware.badblock.hub.config.ConfigLoader;
import fr.xmalware.badblock.hub.link.GetServersDataListener;
import fr.xmalware.badblock.hub.listeners.ListenerPackages;
import lombok.Getter;
import lombok.Setter;

@Getter@Setter public class BadBlockHub extends BadblockPlugin {
	
	@Getter@Setter public static BadBlockHub instance;
	
	private Gson notRestrictiveGson;

	@Override
	public void onEnable(RunType runType) {
		setInstance(this);
		// No game, no life :3
		if (runType.equals(RunType.GAME)) return;
		// Load Gson
		setNotRestrictiveGson(new GsonBuilder().setPrettyPrinting().create());
		// Load configuration
		ConfigLoader.load(this);
		// Linked servers
		// TODO: add a loader
		new GetServersDataListener();
		// Load listeners
		ListenerPackages.load(this);
	}
	
}
