package fr.xmalware.badblock.hub.npc;

import java.util.HashMap;
import java.util.Map;

import org.bukkit.DyeColor;
import org.bukkit.Location;
import org.bukkit.Material;
import org.bukkit.entity.EntityType;
import org.bukkit.entity.Player;
import org.bukkit.inventory.Inventory;

import fr.badblock.gameapi.fakeentities.FakeEntity;
import fr.badblock.gameapi.packets.watchers.WatcherLivingEntity;
import fr.badblock.gameapi.packets.watchers.WatcherZombie;
import fr.xmalware.badblock.hub.npc.inventories.SEntryDataInventory;
import fr.xmalware.badblock.hub.riders.MountManager;
import lombok.Getter;
import lombok.Setter;

@Getter
@Setter
public class NPCData {

	public static Map<Integer, NPCData> stockage;

	static {
		stockage = new HashMap<>();
	}
	private String displayName;
	private EntityType entityType;
	private Inventory inventory;
	private Location location;
	private Material highlightedItem;
	private DyeColor dyeColor;
	private String server;
	private boolean vip;
	private boolean staff;
	private FakeEntity<? extends WatcherLivingEntity> fakeEntity;

	public NPCData(Location location, EntityType entityType, Material highlightedItem, DyeColor dyeColor, boolean vip, boolean staff, String displayName, String server) {
		this.setLocation(location);
		this.setEntityType(entityType);
		this.setHighlightedItem(highlightedItem);
		this.setDyeColor(dyeColor);
		this.setDisplayName(displayName);
		this.setVip(vip);
		this.setStaff(staff);
		this.setServer(server);
		this.setFakeEntity(MountManager.spawn(location, entityType, WatcherZombie.class, false, false, false, false, displayName));
	}

	public void onClick(Player player) {
		this.open(player);
	}

	private void open(Player player) {
		player.closeInventory();
		if (inventory == null)
			inventory = new SEntryDataInventory(this.getDisplayName(), this.getHighlightedItem(), this.getDyeColor(), this.getServer()).getInventory();
		player.openInventory(inventory);
	}
	
	public void remove() {
		fakeEntity.destroy();
	}

}
