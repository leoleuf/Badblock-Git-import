package fr.xmalware.badblock.hub.npc;

import java.util.HashMap;
import java.util.Map;

import org.bukkit.DyeColor;
import org.bukkit.Material;
import org.bukkit.entity.EntityType;
import org.bukkit.entity.Player;
import org.bukkit.inventory.Inventory;

import com.google.gson.annotations.Expose;

import fr.badblock.gameapi.fakeentities.FakeEntity;
import fr.badblock.gameapi.packets.watchers.WatcherLivingEntity;
import fr.badblock.gameapi.packets.watchers.WatcherZombie;
import fr.badblock.gameapi.utils.ConfigUtils;
import fr.xmalware.badblock.hub.npc.inventories.SEntryDataInventory;
import fr.xmalware.badblock.hub.riders.MountManager;
import lombok.Getter;
import lombok.Setter;
import net.md_5.bungee.api.ChatColor;

@Getter
@Setter
public class NPCData {

	public static Map<Integer, NPCData> stockage;

	static {
		stockage = new HashMap<>();
	}
	@Expose private String displayName;
	@Expose private EntityType entityType;
	private Inventory inventory;
	@Expose private String location;
	@Expose private Material highlightedItem;
	@Expose private DyeColor dyeColor;
	@Expose private String server;
	@Expose private boolean vip;
	@Expose private boolean staff;
	private FakeEntity<? extends WatcherLivingEntity> fakeEntity;

	public NPCData(String location, EntityType entityType, Material highlightedItem, DyeColor dyeColor, boolean vip, boolean staff, String displayName, String server) {
		this.setLocation(location);
		this.setEntityType(entityType);
		this.setHighlightedItem(highlightedItem);
		this.setDyeColor(dyeColor);
		this.setDisplayName(displayName);
		this.setVip(vip);
		this.setStaff(staff);
		this.setServer(server);
		this.yop();
	}

	public void yop() {
		this.setFakeEntity(MountManager.spawn(ConfigUtils.convertStringToLocation(location), entityType, WatcherZombie.class, false, false, false, false, ChatColor.translateAlternateColorCodes('&', displayName)));	
		System.out.println("yop");
	}
	
	public void onClick(Player player) {
		this.open(player);
	}

	private void open(Player player) {
		player.closeInventory();
		if (inventory == null)
			inventory = new SEntryDataInventory(this.getDisplayName(), this.getHighlightedItem(), this.getDyeColor(), this.getServer()).getInventory();
		player.openInventory(inventory);
	}
	
	public void remove() {
		fakeEntity.destroy();
	}

}
